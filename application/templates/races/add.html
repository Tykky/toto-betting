{% extends "layout.html" %}

{% block body %}
<div class="container">
  <div class="row">
    <div class="col-sm p-5">
      <div class="row"><h2>Change status</h2></div>
      <div class="row">
        <p>
          <b>Change status</b> changes the race status from 
          open to closed or from closed to open (depending on
          the current state). When status is switched from open to 
          closed, the betting closes and rewards are shared 
          amongst the winners for this specific race. Note that 
          this action <b> cannot be reversed</b>. All the bets 
          for this race are cleared. The race can be re-opened 
          by changing status again and now users can place <b>new</b>
          bets on this race.
        </p>
      </div>
    </div>
    <div class="col-lg p-5">
      <div class="row"><h2>Edit</h2></div>
      <div class="row">
        <p>
          By pressing <b>Edit</b> you are able to edit race name, 
          location, description and which horses attend the race.
          Note that at least 2 horses are required to attend the 
          race. The race cannot be changed to open if there is 
          less than 2 attending horses. 
        </p>
      </div>
    </div>
    <div class="col-lg p-5">
      <div class="row"><h2>Delete</h2></div>
      <div class="row">
        <p>
          Delete deletes the race permanently. Note that this
          <b>is irreversible action</b>. Race can only be 
          deleted when race status is closed. 
        </p>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-sm-5">
      <h2>Add races</h2>
      <form method="POST" action="{{ url_for('add_race') }}">
        <div class="form-group">
          {{ form.name.label }}
          {{ form.name(class_="form-control") }}
        </div>
        <div class="form-group">
          {{ form.location.label }}
          {{ form.location(class_="form-control") }}
        </div>
        <div class="form-group">
          {{ form.description.label }}
          {{ form.description(class_="form-control", cols="40", rows="10") }}
        </div>
        <input type="submit" values="Submit" class="btn btn-primary">
      </form>
    </div>
    <div class="col-sm-6">
      <h2>Current races</h2>
      <table class="table">
        <tr>
          <th>Name</th>
          <th>Location</th>
          <th>Status</th>
          <th>Change status</th>
          <th>Edit</th>
          <th>Delete</th>
        </tr>
        {% for race in races %}
          <tr>
            <td>{{ race.name }}</td>
            <td>{{ race.location }}</td>
            {% if race.isopen %}
              <td> Open </td>
            {% else %}
              <td> Closed </td>
            {% endif %}
            <td>
              <form method="POST" action="{{ url_for('change_race_status',raceid=race.raceid) }}">
                <input type="submit" value="Change" class="btn btn-warning">
              </form>
            </td>
            <td>
              <a href="{{ url_for('edit_race', raceid=race.raceid) }}">Edit</a>
            </td>
            {% if race.isopen %}
              <td>
                <form method="POST" action="{{ url_for('delete_race', raceid=race.raceid) }}">
                  <input type="submit" value="Delete" class="btn btn-danger">
                </form>
              </td>
            {% else %}
              <td></td>
            {% endif %}
          </tr>
        {% endfor %}
      </table>
    </div>
  </div>
</div>
{% endblock %}